{"Invoice_Customer_TradingTerms":{"action":"augment","parameters":{"right_key":["CustNameNew","PRODUCT_LINE_NAME1"],"right_select":["On_invoice_Discount","Customer","Product_Group","Channel"],"left":"Invoice_CustomerChannel","left_key":["CustNameNew","PRODUCT_LINE_NAME1"],"name":"Invoice_Customer_TradingTerms","right":"Compute_TT","relationship":"TradingTerms"}},"Invoice":{"action":"edgemart","parameters":{"name":"Invoice","alias":"QAD_INVOICE_DATA_DATASET"}},"Invoice_CustomerChannel":{"action":"augment","parameters":{"right_key":["CustomerNew"],"right_select":["Site","Customer_Name","Customer","CustomerNew","Channel","Ship_To","Country","Customer_Group","Domain","Postal_Code","Segment","State"],"left":"Compute_InvoiceCode","left_key":["CustomerNew"],"name":"Invoice_CustomerChannel","right":"Compute_CustomerHieracrhyCode","relationship":"CustomerChannel"}},"ComputeDimension":{"action":"computeExpression","parameters":{"name":"ComputeDimension","source":"compute1","mergeWithSource":true,"computedFields":[{"fiscalMonthOffset":6,"defaultValue":"","name":"DUE_DATE1","saqlExpression":"toDate('DUE_DATE', \"yyyy-MM-dd\")","format":"yyyy-MM-dd","label":"DUE_DATE1","type":"Date"},{"default":"","name":"Week_New","saqlExpression":"case when ('DUE_DATE_Day' >= \"01\" and 'DUE_DATE_Day' <= \"07\") then \"01\" when ('DUE_DATE_Day' >= \"08\" and 'DUE_DATE_Day' <= \"14\") then \"02\" when ('DUE_DATE_Day' >= \"15\" and 'DUE_DATE_Day' <= \"21\") then \"03\" when ('DUE_DATE_Day' >= \"22\" and 'DUE_DATE_Day' <= \"28\") then \"04\" else \"05\" end","label":"Week_New","type":"Text"},{"default":"","name":"Country2","saqlExpression":"upper(Country1)","label":"Country2","type":"Text"},{"default":"","name":"Channel2","saqlExpression":"upper(Channel1)","label":"Channel2","type":"Text"},{"default":"","name":"Customer_Group2","saqlExpression":"upper('CustomerChannel.Customer_Group')","label":"Customer_Group2","type":"Text"},{"default":"","name":"Customer_Name2","saqlExpression":"upper(Customer_Name1)","label":"Customer_Name2","type":"Text"},{"default":"","name":"PRODUCT_LINE_NAME2","saqlExpression":"upper(PRODUCT_LINE_NAME)","label":"PRODUCT_LINE_NAME2","type":"Text"},{"default":"","name":"Customer_New","saqlExpression":"case when starts_with(Customer_Name2, \"A2\") == true && Customer_Name2!=\"A2 SAMPLES\" then  \"EXCLUSION\" else  Customer_Name2 end","label":"Customer_New","type":"Text"},{"default":"","name":"Domain1","saqlExpression":"upper('CustomerChannel.Domain')","label":"Domain1","type":"Text"}]}},"CustomerProfitability":{"action":"sfdcRegister","parameters":{"name":"CustomerProfitability1","alias":"CustomerProfitability1","source":"Dim2Mea_DueDateDay","folderid":[]}},"TradingTerms":{"action":"edgemart","parameters":{"name":"TradingTerms1","alias":"TradingTerms11"}},"Dim2Mea_DueDateDay":{"action":"dim2mea","parameters":{"measure":"DUE_DATE2_Day","measureDefault":"0","source":"ComputeDimension","dimension":"DUE_DATE1_Day","measureType":"long"}},"compute":{"action":"computeExpression","parameters":{"name":"compute","source":"Invoice_Customer_TradingTerms","mergeWithSource":true,"computedFields":[{"default":"","precision":10,"name":"Margin_New","saqlExpression":"EXT_PRICE-EXTCOST","scale":2,"label":"Margin_New","type":"Numeric"},{"default":"","precision":10,"name":"TradingTermPerUnit","saqlExpression":"(EXT_PRICE/CONVERTED_QTY_LTR_KG)*'TradingTerms.On_invoice_Discount'","scale":2,"label":"TradingTermPerUnit","type":"Numeric"},{"default":"","precision":10,"name":"NetSales","saqlExpression":"(EXT_PRICE/CONVERTED_QTY_LTR_KG) - TradingTermPerUnit","scale":2,"label":"NetSales","type":"Numeric"},{"default":"","precision":10,"name":"COGS_Per_Unit","saqlExpression":"EXTCOST/CONVERTED_QTY_LTR_KG","scale":2,"label":"COGS_Per_Unit","type":"Numeric"},{"default":"","precision":10,"name":"GrossMarginPreFreight","saqlExpression":"NetSales - COGS_Per_Unit","scale":2,"label":"GrossMarginPreFreight","type":"Numeric"},{"default":"","precision":10,"name":"InvoicePricePerUnit","saqlExpression":"EXT_PRICE/CONVERTED_QTY_LTR_KG","scale":2,"label":"InvoicePricePerUnit","type":"Numeric"},{"default":"","precision":10,"name":"GM_NetSales","saqlExpression":"GrossMarginPreFreight/NetSales","scale":2,"label":"GM_NetSales","type":"Numeric"}]}},"Compute_InvoiceCode":{"action":"computeExpression","parameters":{"name":"Compute_InvoiceCode","source":"Invoice","mergeWithSource":true,"computedFields":[{"default":"","name":"CustomerNew","saqlExpression":"upper(CUSTOMER)","label":"CustomerNew","type":"Text"},{"default":"","name":"CustNameNew","saqlExpression":"upper(CUSTOMER_NAME)","label":"CustNameNew","type":"Text"},{"default":"","name":"PRODUCT_LINE_NAME1","saqlExpression":"upper(PRODUCT_LINE_NAME)","label":"PRODUCT_LINE_NAME1","type":"Text"}]}},"compute1":{"action":"computeExpression","parameters":{"name":"compute","source":"FinalDS","mergeWithSource":true,"computedFields":[{"default":"","precision":15,"name":"FreightPerUnit","saqlExpression":"'Freight.sum_gltr_amt'/CONVERTED_QTY_LTR_KG","scale":4,"label":"FreightPerUnit","type":"Numeric"},{"default":"","name":"ProductName","saqlExpression":"upper('SKU_NAME')","label":"ProductName","type":"Text"},{"default":"","precision":10,"name":"GrossMarginPostFreight","saqlExpression":"(GrossMarginPreFreight) - FreightPerUnit","scale":2,"label":"GrossMarginPostFreight","type":"Numeric"},{"default":"","precision":10,"name":"GrossMarginPostFreightNetSales","saqlExpression":"GrossMarginPostFreight/NetSales","scale":2,"label":"GrossMarginPostFreightNetSales","type":"Numeric"},{"default":"","name":"Country1","saqlExpression":"case when len('CustomerChannel.Customer')>=0 then 'CustomerChannel.Country' else \"Other\" end","label":"Country1","type":"Text"},{"default":"","name":"Channel1","saqlExpression":"case when len('CustomerChannel.Customer')>=0 then 'CustomerChannel.Channel' else \"Other\" end","label":"Channel1","type":"Text"},{"default":"","name":"Customer_Group1","saqlExpression":"case when len('CustomerChannel.Customer')>=0 then 'CustomerChannel.Customer_Group' else \"Other\" end","label":"Customer_Group1","type":"Text"},{"default":"0","precision":10,"name":"CONVERTED_QTY_LTR_KG1","saqlExpression":"case when Converted_KG>0 || Converted_KG<0 then Converted_KG else QTY_INV_LITRES end","scale":2,"label":"CONVERTED_QTY_LTR_KG1","type":"Numeric"},{"default":"","name":"Customer_Name1","saqlExpression":"case when len('CustomerChannel.Customer')>=0 then 'CustomerChannel.Customer_Name' else \"Other\" end","label":"Customer_Name1","type":"Text"}]}},"CustomerChannel":{"action":"edgemart","parameters":{"name":"CustomerChannelHierarchy","alias":"CustomerChannelHierarchy1"}},"FinalDS":{"action":"augment","parameters":{"right_key":["SALESORDER_NUMBER"],"right_select":["sum_gltr_amt","SALESORDER_NUMBER"],"left":"compute","left_key":["SALES_ORDER"],"name":"FinalDS","right":"Freight","relationship":"Freight","operation":"LookupMultiValue"}},"Compute_CustomerHieracrhyCode":{"action":"computeExpression","parameters":{"name":"Compute_CustomerHieracrhyCode","source":"CustomerChannel","mergeWithSource":true,"computedFields":[{"default":"","name":"CustomerNew","saqlExpression":"upper(Customer)","label":"CustomerNew","type":"Text"}]}},"Freight":{"action":"edgemart","parameters":{"name":"Freight","alias":"Freight"}},"Compute_TT":{"action":"computeExpression","parameters":{"name":"Compute_TT","source":"TradingTerms","mergeWithSource":true,"computedFields":[{"default":"","name":"CustNameNew","saqlExpression":"upper(Customer)","label":"CustNameNew","type":"Text"},{"default":"","name":"PRODUCT_LINE_NAME1","saqlExpression":"upper(Product_Group)","label":"PRODUCT_LINE_NAME1","type":"Text"}]}}}